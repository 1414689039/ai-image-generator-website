(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,790502,e=>{"use strict";var t=e.i(843476),n=e.i(167881),a=e.i(463415),r=e.i(920755),s=e.i(475254);let o=(0,s.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),i=(0,s.default)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var l=e.i(561659),d=e.i(915505);let u=(0,s.default)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),c=(0,s.default)("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);var m=e.i(16715),x=e.i(522016),f=e.i(589188),p=e.i(618566),h=e.i(271645),v=e.i(647163),g=e.i(120682);function w({avatarUrl:e}){let s=(0,p.useRouter)(),{toast:w}=(0,g.useToast)(),[j,N]=(0,h.useState)(null),[y,b]=(0,h.useState)(null),[C,k]=(0,h.useState)(!1),[T,E]=(0,h.useState)(e),[M,R]=(0,h.useState)(!1),_=async()=>{let e=(0,r.createClient)();await e.auth.signOut(),s.push("/auth/login")},I=(0,h.useCallback)(async()=>{let e=(0,r.createClient)(),{data:t}=await e.auth.getUser(),n=t?.user;if(!n)return;let{data:a}=await e.from("user_profiles").select("username,email,role,membership_expire_at,avatar").eq("id",n.id).single(),{data:s}=await e.rpc("get_user_stats");a&&(N({...a,role:s?.role??a.role,points:s?.points??0,daily_limit:s?.daily_limit??0}),a.avatar&&E(a.avatar));let{data:o}=await e.rpc("get_my_daily_usage");b("number"==typeof o?o:0)},[]),S=async e=>{e.preventDefault(),e.stopPropagation(),R(!0);try{let e=(0,r.createClient)(),{error:t}=await e.rpc("manual_sync_user_profile");if(t)throw console.error("Sync error:",t),t;await I(),w({title:"同步成功",description:"账号积分与等级已更新"})}catch(e){console.error("Failed to sync profile:",e),w({title:"同步失败",description:"请稍后重试",variant:"destructive"})}finally{setTimeout(()=>R(!1),500)}};(0,h.useEffect)(()=>{I();let e=()=>I(),t=async()=>{let e=(0,r.createClient)(),{data:t}=await e.auth.getUser();if(!t?.user)return;let{data:n}=await e.from("user_profiles").select("avatar").eq("id",t.user.id).single();n?.avatar&&E(n.avatar)},n=async()=>{let e=(0,r.createClient)(),{data:t}=await e.rpc("get_my_daily_usage");b("number"==typeof t?t:0)};return window.addEventListener("profile:updated",e),window.addEventListener("profile:updated",t),window.addEventListener("daily_usage:updated",n),()=>{window.removeEventListener("profile:updated",e),window.removeEventListener("profile:updated",t),window.removeEventListener("daily_usage:updated",n)}},[I]);let z=j?.daily_limit!==void 0&&j?.daily_limit!==null?parseFloat(j.daily_limit):void 0,D=void 0!==z?Math.max(z-(y??0),0):void 0,P=j?.points!==void 0&&j?.points!==null?Number(j.points).toFixed(2):void 0;return void 0!==D&&Number(D).toFixed(0),void 0!==z&&Number(z).toFixed(0),(0,t.jsxs)(a.DropdownMenu,{open:C,onOpenChange:k,children:[(0,t.jsx)(a.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",className:"rounded-full",onMouseEnter:()=>k(!0),children:(0,t.jsx)("img",{src:T,alt:"avatar",className:"h-8 w-8 rounded-full"})})}),(0,t.jsxs)(a.DropdownMenuContent,{className:"w-64",align:"end",sideOffset:8,collisionPadding:0,onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:[(0,t.jsx)(a.DropdownMenuLabel,{children:(0,t.jsx)(f.I18nText,{token:"menu_account_header"})}),(0,t.jsxs)(a.DropdownMenuGroup,{children:[(0,t.jsxs)(a.DropdownMenuItem,{children:[(0,t.jsx)(f.I18nText,{token:"menu_username"}),j?.username?(0,t.jsx)("span",{className:"ml-auto text-foreground/80 text-xs",children:j.username}):null]}),(0,t.jsxs)(a.DropdownMenuItem,{children:[(0,t.jsx)(f.I18nText,{token:"menu_email"}),j?.email?(0,t.jsx)("span",{className:"ml-auto text-foreground/80 text-xs truncate max-w-[12rem]",children:j.email}):null]}),(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:()=>{s.push("/settings/tier")},children:[(0,t.jsx)(f.I18nText,{token:"menu_account_status"}),j?.role?(0,t.jsx)("span",{className:"ml-auto text-foreground/80 text-xs capitalize",children:j.role}):null]}),j?.role==="T2"&&j?.membership_expire_at?(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:()=>{s.push("/settings/tier")},children:[(0,t.jsx)(f.I18nText,{token:"menu_expiration_date"}),(0,t.jsx)("span",{className:"ml-auto text-foreground/80 text-xs",children:new Date(j.membership_expire_at).toLocaleDateString()})]}):null,(0,t.jsx)(a.DropdownMenuItem,{asChild:!0,className:"cursor-pointer",children:(0,t.jsx)(x.default,{href:"/settings/account",children:(0,t.jsxs)("span",{className:"flex w-full items-center",children:[(0,t.jsx)(f.I18nText,{token:"menu_settings"}),(0,t.jsx)("span",{className:"ml-auto text-muted-foreground",children:(0,t.jsx)(i,{className:"h-3.5 w-3.5"})})]})})})]}),(0,t.jsx)(a.DropdownMenuSeparator,{}),(0,t.jsxs)(a.DropdownMenuGroup,{children:[(0,t.jsxs)("div",{className:"flex items-center px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex-1 flex items-center",onClick:()=>{k(!1),s.push("/settings/usage")},children:[(0,t.jsx)(f.I18nText,{token:"menu_credit"}),void 0!==P?(0,t.jsxs)("span",{className:"ml-auto flex items-center gap-1.5 text-foreground/80 text-xs mr-2",children:[(0,t.jsx)("img",{src:"/icons/points.svg",alt:"points",className:"h-3 w-3 opacity-80"}),P]}):null]}),void 0!==P&&(0,t.jsx)("div",{className:"p-1 hover:bg-muted-foreground/20 rounded-full cursor-pointer transition-colors shrink-0",onClick:S,title:"Sync Points",children:(0,t.jsx)(m.RefreshCw,{className:(0,v.cn)("h-3 w-3",M&&"animate-spin")})})]}),(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:()=>{s.push("/settings/api-keys")},children:[(0,t.jsx)(f.I18nText,{token:"menu_api_keys"}),(0,t.jsx)("span",{className:"ml-auto text-muted-foreground",children:(0,t.jsx)(c,{className:"h-3.5 w-3.5"})})]})]}),(0,t.jsx)(a.DropdownMenuSeparator,{}),(0,t.jsxs)(a.DropdownMenuGroup,{children:[(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:()=>{s.push("/settings/credits")},children:[(0,t.jsx)(f.I18nText,{token:"menu_buy_credits"}),(0,t.jsx)("span",{className:"ml-auto text-muted-foreground",children:(0,t.jsx)(l.CreditCard,{className:"h-3.5 w-3.5"})})]}),(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:()=>{s.push("/settings/credits")},children:[(0,t.jsx)(f.I18nText,{token:"menu_redeem_card"}),(0,t.jsx)("span",{className:"ml-auto text-muted-foreground",children:(0,t.jsx)(d.ArrowLeftRight,{className:"h-3.5 w-3.5"})})]}),(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:()=>{s.push("/settings/support")},children:[(0,t.jsx)(f.I18nText,{token:"menu_support"}),(0,t.jsx)("span",{className:"ml-auto text-muted-foreground",children:(0,t.jsx)(u,{className:"h-3.5 w-3.5"})})]})]}),(0,t.jsx)(a.DropdownMenuSeparator,{}),(0,t.jsxs)(a.DropdownMenuItem,{className:"cursor-pointer",onSelect:_,children:[(0,t.jsx)(f.I18nText,{token:"logout"}),(0,t.jsx)("span",{className:"ml-auto text-muted-foreground",children:(0,t.jsx)(o,{className:"h-3.5 w-3.5"})})]})]})]})}e.s(["UserAvatarMenu",()=>w],790502)},208804,e=>{"use strict";var t=e.i(843476),n=e.i(167881),a=e.i(475254);let r=(0,a.default)("moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),s=(0,a.default)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var o=e.i(363178),i=e.i(271645);let l=()=>{let[e,a]=(0,i.useState)(!1),{theme:l,resolvedTheme:d,setTheme:u}=(0,o.useTheme)();return((0,i.useEffect)(()=>{a(!0)},[]),e)?(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",className:"px-2",onClick:()=>{u("dark"===(d??l)?"light":"dark")},children:(d??l)==="light"?(0,t.jsx)(s,{size:16,className:"text-muted-foreground"},"light"):(0,t.jsx)(r,{size:16,className:"text-muted-foreground"},"dark")}):null};e.s(["ThemeSwitcher",()=>l],208804)},17467,e=>{"use strict";var t=e.i(843476),n=e.i(167881),a=e.i(773955);function r(){let{lang:e,setLang:r,t:s}=(0,a.useI18n)(),o="zh"===e?"en":"zh",i=s("zh"===e?"zh_label":"en_label");return(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>r(o),className:"w-8 px-0.5 justify-center",children:i})}e.s(["LanguageSwitcher",()=>r])},892182,e=>{"use strict";var t=e.i(843476),n=e.i(522016),a=e.i(271645),r=e.i(589188),s=e.i(618566),o=e.i(647163),i=e.i(174080),l=e.i(30030),d=e.i(981140),u=e.i(248425),c=e.i(369340),m=e.i(820783),x=e.i(586318),f=e.i(296626),p=e.i(610772),h=e.i(75830),v=e.i(726330),g=e.i(999682),w=e.i(934620),j=e.i(30207),N=e.i(959411),y="NavigationMenu",[b,C,k]=(0,h.createCollection)(y),[T,E,M]=(0,h.createCollection)(y),[R,_]=(0,l.createContextScope)(y,[k,M]),[I,S]=R(y),[z,D]=R(y),P=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:r,value:s,onValueChange:o,defaultValue:i,delayDuration:l=200,skipDelayDuration:d=300,orientation:f="horizontal",dir:p,...h}=e,[v,g]=a.useState(null),w=(0,m.useComposedRefs)(n,e=>g(e)),j=(0,x.useDirection)(p),N=a.useRef(0),b=a.useRef(0),C=a.useRef(0),[k,T]=a.useState(!0),[E,M]=(0,c.useControllableState)({prop:s,onChange:e=>{let t=d>0;""!==e?(window.clearTimeout(C.current),t&&T(!1)):(window.clearTimeout(C.current),C.current=window.setTimeout(()=>T(!0),d)),o?.(e)},defaultProp:i??"",caller:y}),R=a.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>M(""),150)},[M]),_=a.useCallback(e=>{window.clearTimeout(b.current),M(e)},[M]),I=a.useCallback(e=>{E===e?window.clearTimeout(b.current):N.current=window.setTimeout(()=>{window.clearTimeout(b.current),M(e)},l)},[E,M,l]);return a.useEffect(()=>()=>{window.clearTimeout(N.current),window.clearTimeout(b.current),window.clearTimeout(C.current)},[]),(0,t.jsx)(F,{scope:r,isRootMenu:!0,value:E,dir:j,orientation:f,rootNavigationMenu:v,onTriggerEnter:e=>{window.clearTimeout(N.current),k?I(e):_(e)},onTriggerLeave:()=>{window.clearTimeout(N.current),R()},onContentEnter:()=>window.clearTimeout(b.current),onContentLeave:R,onItemSelect:e=>{M(t=>t===e?"":e)},onItemDismiss:()=>M(""),children:(0,t.jsx)(u.Primitive.nav,{"aria-label":"Main","data-orientation":f,dir:j,...h,ref:w})})});P.displayName=y;var L="NavigationMenuSub";a.forwardRef((e,n)=>{let{__scopeNavigationMenu:a,value:r,onValueChange:s,defaultValue:o,orientation:i="horizontal",...l}=e,d=S(L,a),[m,x]=(0,c.useControllableState)({prop:r,onChange:s,defaultProp:o??"",caller:L});return(0,t.jsx)(F,{scope:a,isRootMenu:!1,value:m,dir:d.dir,orientation:i,rootNavigationMenu:d.rootNavigationMenu,onTriggerEnter:e=>x(e),onItemSelect:e=>x(e),onItemDismiss:()=>x(""),children:(0,t.jsx)(u.Primitive.div,{"data-orientation":i,...l,ref:n})})}).displayName=L;var F=e=>{let{scope:n,isRootMenu:r,rootNavigationMenu:s,dir:o,orientation:i,children:l,value:d,onItemSelect:u,onItemDismiss:c,onTriggerEnter:m,onTriggerLeave:x,onContentEnter:f,onContentLeave:h}=e,[v,w]=a.useState(null),[N,y]=a.useState(new Map),[C,k]=a.useState(null);return(0,t.jsx)(I,{scope:n,isRootMenu:r,rootNavigationMenu:s,value:d,previousValue:(0,g.usePrevious)(d),baseId:(0,p.useId)(),dir:o,orientation:i,viewport:v,onViewportChange:w,indicatorTrack:C,onIndicatorTrackChange:k,onTriggerEnter:(0,j.useCallbackRef)(m),onTriggerLeave:(0,j.useCallbackRef)(x),onContentEnter:(0,j.useCallbackRef)(f),onContentLeave:(0,j.useCallbackRef)(h),onItemSelect:(0,j.useCallbackRef)(u),onItemDismiss:(0,j.useCallbackRef)(c),onViewportContentChange:a.useCallback((e,t)=>{y(n=>(n.set(e,t),new Map(n)))},[]),onViewportContentRemove:a.useCallback(e=>{y(t=>t.has(e)?(t.delete(e),new Map(t)):t)},[]),children:(0,t.jsx)(b.Provider,{scope:n,children:(0,t.jsx)(z,{scope:n,items:N,children:l})})})},A="NavigationMenuList",H=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:a,...r}=e,s=S(A,a),o=(0,t.jsx)(u.Primitive.ul,{"data-orientation":s.orientation,...r,ref:n});return(0,t.jsx)(u.Primitive.div,{style:{position:"relative"},ref:s.onIndicatorTrackChange,children:(0,t.jsx)(b.Slot,{scope:a,children:s.isRootMenu?(0,t.jsx)(er,{asChild:!0,children:o}):o})})});H.displayName=A;var O="NavigationMenuItem",[K,U]=R(O),V=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:r,value:s,...o}=e,i=(0,p.useId)(),l=a.useRef(null),d=a.useRef(null),c=a.useRef(null),m=a.useRef(()=>{}),x=a.useRef(!1),f=a.useCallback((e="start")=>{if(l.current){m.current();let t=ei(l.current);t.length&&el("start"===e?t:t.reverse())}},[]),h=a.useCallback(()=>{if(l.current){var e;let t=ei(l.current);t.length&&((e=t).forEach(e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")}),m.current=()=>{e.forEach(e=>{let t=e.dataset.tabindex;e.setAttribute("tabindex",t)})})}},[]);return(0,t.jsx)(K,{scope:r,value:s||i||"LEGACY_REACT_AUTO_VALUE",triggerRef:d,contentRef:l,focusProxyRef:c,wasEscapeCloseRef:x,onEntryKeyDown:f,onFocusProxyEnter:f,onRootContentClose:h,onContentFocusOutside:h,children:(0,t.jsx)(u.Primitive.li,{...o,ref:n})})});V.displayName=O;var B="NavigationMenuTrigger",G=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:r,disabled:s,...o}=e,i=S(B,e.__scopeNavigationMenu),l=U(B,e.__scopeNavigationMenu),c=a.useRef(null),x=(0,m.useComposedRefs)(c,l.triggerRef,n),f=ec(i.baseId,l.value),p=em(i.baseId,l.value),h=a.useRef(!1),v=a.useRef(!1),g=l.value===i.value;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.ItemSlot,{scope:r,value:l.value,children:(0,t.jsx)(eo,{asChild:!0,children:(0,t.jsx)(u.Primitive.button,{id:f,disabled:s,"data-disabled":s?"":void 0,"data-state":eu(g),"aria-expanded":g,"aria-controls":p,...o,ref:x,onPointerEnter:(0,d.composeEventHandlers)(e.onPointerEnter,()=>{v.current=!1,l.wasEscapeCloseRef.current=!1}),onPointerMove:(0,d.composeEventHandlers)(e.onPointerMove,ex(()=>{s||v.current||l.wasEscapeCloseRef.current||h.current||(i.onTriggerEnter(l.value),h.current=!0)})),onPointerLeave:(0,d.composeEventHandlers)(e.onPointerLeave,ex(()=>{s||(i.onTriggerLeave(),h.current=!1)})),onClick:(0,d.composeEventHandlers)(e.onClick,()=>{i.onItemSelect(l.value),v.current=g}),onKeyDown:(0,d.composeEventHandlers)(e.onKeyDown,e=>{let t={horizontal:"ArrowDown",vertical:"rtl"===i.dir?"ArrowLeft":"ArrowRight"}[i.orientation];g&&e.key===t&&(l.onEntryKeyDown(),e.preventDefault())})})})}),g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Root,{"aria-hidden":!0,tabIndex:0,ref:l.focusProxyRef,onFocus:e=>{let t=l.contentRef.current,n=e.relatedTarget,a=n===c.current,r=t?.contains(n);(a||!r)&&l.onFocusProxyEnter(a?"start":"end")}}),i.viewport&&(0,t.jsx)("span",{"aria-owns":p})]})]})});G.displayName=B;var q="navigationMenu.linkSelect",$=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:a,active:r,onSelect:s,...o}=e;return(0,t.jsx)(eo,{asChild:!0,children:(0,t.jsx)(u.Primitive.a,{"data-active":r?"":void 0,"aria-current":r?"page":void 0,...o,ref:n,onClick:(0,d.composeEventHandlers)(e.onClick,e=>{let t=e.target,n=new CustomEvent(q,{bubbles:!0,cancelable:!0});if(t.addEventListener(q,e=>s?.(e),{once:!0}),(0,u.dispatchDiscreteCustomEvent)(t,n),!n.defaultPrevented&&!e.metaKey){let e=new CustomEvent(J,{bubbles:!0,cancelable:!0});(0,u.dispatchDiscreteCustomEvent)(t,e)}},{checkForDefaultPrevented:!1})})})});$.displayName="NavigationMenuLink";var W="NavigationMenuIndicator";a.forwardRef((e,n)=>{let{forceMount:a,...r}=e,s=S(W,e.__scopeNavigationMenu),o=!!s.value;return s.indicatorTrack?i.default.createPortal((0,t.jsx)(f.Presence,{present:a||o,children:(0,t.jsx)(Y,{...r,ref:n})}),s.indicatorTrack):null}).displayName=W;var Y=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:r,...s}=e,o=S(W,r),i=C(r),[l,d]=a.useState(null),[c,m]=a.useState(null),x="horizontal"===o.orientation,f=!!o.value;a.useEffect(()=>{let e=i(),t=e.find(e=>e.value===o.value)?.ref.current;t&&d(t)},[i,o.value]);let p=()=>{l&&m({size:x?l.offsetWidth:l.offsetHeight,offset:x?l.offsetLeft:l.offsetTop})};return ed(l,p),ed(o.indicatorTrack,p),c?(0,t.jsx)(u.Primitive.div,{"aria-hidden":!0,"data-state":f?"visible":"hidden","data-orientation":o.orientation,...s,ref:n,style:{position:"absolute",...x?{left:0,width:c.size+"px",transform:`translateX(${c.offset}px)`}:{top:0,height:c.size+"px",transform:`translateY(${c.offset}px)`},...s.style}}):null}),Q="NavigationMenuContent",X=a.forwardRef((e,n)=>{let{forceMount:a,...r}=e,s=S(Q,e.__scopeNavigationMenu),o=U(Q,e.__scopeNavigationMenu),i=(0,m.useComposedRefs)(o.contentRef,n),l=o.value===s.value,u={value:o.value,triggerRef:o.triggerRef,focusProxyRef:o.focusProxyRef,wasEscapeCloseRef:o.wasEscapeCloseRef,onContentFocusOutside:o.onContentFocusOutside,onRootContentClose:o.onRootContentClose,...r};return s.viewport?(0,t.jsx)(Z,{forceMount:a,...u,ref:i}):(0,t.jsx)(f.Presence,{present:a||l,children:(0,t.jsx)(ee,{"data-state":eu(l),...u,ref:i,onPointerEnter:(0,d.composeEventHandlers)(e.onPointerEnter,s.onContentEnter),onPointerLeave:(0,d.composeEventHandlers)(e.onPointerLeave,ex(s.onContentLeave)),style:{pointerEvents:!l&&s.isRootMenu?"none":void 0,...u.style}})})});X.displayName=Q;var Z=a.forwardRef((e,t)=>{let{onViewportContentChange:n,onViewportContentRemove:a}=S(Q,e.__scopeNavigationMenu);return(0,w.useLayoutEffect)(()=>{n(e.value,{ref:t,...e})},[e,t,n]),(0,w.useLayoutEffect)(()=>()=>a(e.value),[e.value,a]),null}),J="navigationMenu.rootContentDismiss",ee=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:r,value:s,triggerRef:o,focusProxyRef:i,wasEscapeCloseRef:l,onRootContentClose:u,onContentFocusOutside:c,...x}=e,f=S(Q,r),p=a.useRef(null),h=(0,m.useComposedRefs)(p,n),g=ec(f.baseId,s),w=em(f.baseId,s),j=C(r),N=a.useRef(null),{onItemDismiss:y}=f;a.useEffect(()=>{let e=p.current;if(f.isRootMenu&&e){let t=()=>{y(),u(),e.contains(document.activeElement)&&o.current?.focus()};return e.addEventListener(J,t),()=>e.removeEventListener(J,t)}},[f.isRootMenu,e.value,o,y,u]);let b=a.useMemo(()=>{let e=j().map(e=>e.value);"rtl"===f.dir&&e.reverse();let t=e.indexOf(f.value),n=e.indexOf(f.previousValue),a=s===f.value,r=n===e.indexOf(s);if(!a&&!r)return N.current;let o=(()=>{if(t!==n){if(a&&-1!==n)return t>n?"from-end":"from-start";if(r&&-1!==t)return t>n?"to-start":"to-end"}return null})();return N.current=o,o},[f.previousValue,f.value,f.dir,j,s]);return(0,t.jsx)(er,{asChild:!0,children:(0,t.jsx)(v.DismissableLayer,{id:w,"aria-labelledby":g,"data-motion":b,"data-orientation":f.orientation,...x,ref:h,disableOutsidePointerEvents:!1,onDismiss:()=>{let e=new Event(J,{bubbles:!0,cancelable:!0});p.current?.dispatchEvent(e)},onFocusOutside:(0,d.composeEventHandlers)(e.onFocusOutside,e=>{c();let t=e.target;f.rootNavigationMenu?.contains(t)&&e.preventDefault()}),onPointerDownOutside:(0,d.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.target,n=j().some(e=>e.ref.current?.contains(t)),a=f.isRootMenu&&f.viewport?.contains(t);(n||a||!f.isRootMenu)&&e.preventDefault()}),onKeyDown:(0,d.composeEventHandlers)(e.onKeyDown,e=>{let t=e.altKey||e.ctrlKey||e.metaKey;if("Tab"===e.key&&!t){let t=ei(e.currentTarget),n=document.activeElement,a=t.findIndex(e=>e===n);el(e.shiftKey?t.slice(0,a).reverse():t.slice(a+1,t.length))?e.preventDefault():i.current?.focus()}}),onEscapeKeyDown:(0,d.composeEventHandlers)(e.onEscapeKeyDown,e=>{l.current=!0})})})}),et="NavigationMenuViewport",en=a.forwardRef((e,n)=>{let{forceMount:a,...r}=e,s=!!S(et,e.__scopeNavigationMenu).value;return(0,t.jsx)(f.Presence,{present:a||s,children:(0,t.jsx)(ea,{...r,ref:n})})});en.displayName=et;var ea=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:r,children:s,...o}=e,i=S(et,r),l=(0,m.useComposedRefs)(n,i.onViewportChange),c=D(Q,e.__scopeNavigationMenu),[x,p]=a.useState(null),[h,v]=a.useState(null),g=x?x?.width+"px":void 0,w=x?x?.height+"px":void 0,j=!!i.value,N=j?i.value:i.previousValue;return ed(h,()=>{h&&p({width:h.offsetWidth,height:h.offsetHeight})}),(0,t.jsx)(u.Primitive.div,{"data-state":eu(j),"data-orientation":i.orientation,...o,ref:l,style:{pointerEvents:!j&&i.isRootMenu?"none":void 0,"--radix-navigation-menu-viewport-width":g,"--radix-navigation-menu-viewport-height":w,...o.style},onPointerEnter:(0,d.composeEventHandlers)(e.onPointerEnter,i.onContentEnter),onPointerLeave:(0,d.composeEventHandlers)(e.onPointerLeave,ex(i.onContentLeave)),children:Array.from(c.items).map(([e,{ref:n,forceMount:a,...r}])=>{let s=N===e;return(0,t.jsx)(f.Presence,{present:a||s,children:(0,t.jsx)(ee,{...r,ref:(0,m.composeRefs)(n,e=>{s&&e&&v(e)})})},e)})})}),er=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:a,...r}=e,s=S("FocusGroup",a);return(0,t.jsx)(T.Provider,{scope:a,children:(0,t.jsx)(T.Slot,{scope:a,children:(0,t.jsx)(u.Primitive.div,{dir:s.dir,...r,ref:n})})})}),es=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],eo=a.forwardRef((e,n)=>{let{__scopeNavigationMenu:a,...r}=e,s=E(a),o=S("FocusGroupItem",a);return(0,t.jsx)(T.ItemSlot,{scope:a,children:(0,t.jsx)(u.Primitive.button,{...r,ref:n,onKeyDown:(0,d.composeEventHandlers)(e.onKeyDown,e=>{if(["Home","End",...es].includes(e.key)){let t=s().map(e=>e.ref.current);if(["rtl"===o.dir?"ArrowRight":"ArrowLeft","ArrowUp","End"].includes(e.key)&&t.reverse(),es.includes(e.key)){let n=t.indexOf(e.currentTarget);t=t.slice(n+1)}setTimeout(()=>el(t)),e.preventDefault()}})})})});function ei(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function el(e){let t=document.activeElement;return e.some(e=>e===t||(e.focus(),document.activeElement!==t))}function ed(e,t){let n=(0,j.useCallbackRef)(t);(0,w.useLayoutEffect)(()=>{let t=0;if(e){let a=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(t),a.unobserve(e)}}},[e,n])}function eu(e){return e?"open":"closed"}function ec(e,t){return`${e}-trigger-${t}`}function em(e,t){return`${e}-content-${t}`}function ex(e){return t=>"mouse"===t.pointerType?e(t):void 0}var ef=e.i(225913),ep=e.i(409797);function eh({className:e,children:n,viewport:a=!0,...r}){return(0,t.jsxs)(P,{"data-slot":"navigation-menu","data-viewport":a,className:(0,o.cn)("group/navigation-menu relative flex max-w-max flex-1 items-center justify-center",e),...r,children:[n,a&&(0,t.jsx)(ey,{})]})}function ev({className:e,...n}){return(0,t.jsx)(H,{"data-slot":"navigation-menu-list",className:(0,o.cn)("group flex flex-1 list-none items-center justify-center gap-1",e),...n})}function eg({className:e,...n}){return(0,t.jsx)(V,{"data-slot":"navigation-menu-item",className:(0,o.cn)("relative",e),...n})}let ew=(0,ef.cva)("group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=open]:hover:bg-accent data-[state=open]:text-accent-foreground data-[state=open]:focus:bg-accent data-[state=open]:bg-accent/50 focus-visible:ring-ring/50 outline-none transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1");function ej({className:e,children:n,...a}){return(0,t.jsxs)(G,{"data-slot":"navigation-menu-trigger",className:(0,o.cn)(ew(),"group",e),...a,children:[n," ",(0,t.jsx)(ep.ChevronDownIcon,{className:"relative top-[1px] ml-1 size-3 transition duration-300 group-data-[state=open]:rotate-180","aria-hidden":"true"})]})}function eN({className:e,...n}){return(0,t.jsx)(X,{"data-slot":"navigation-menu-content",className:(0,o.cn)("data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 top-0 left-0 w-full p-2 pr-2.5 md:absolute md:w-auto z-50","group-data-[viewport=false]/navigation-menu:bg-popover group-data-[viewport=false]/navigation-menu:text-popover-foreground group-data-[viewport=false]/navigation-menu:data-[state=open]:animate-in group-data-[viewport=false]/navigation-menu:data-[state=closed]:animate-out group-data-[viewport=false]/navigation-menu:data-[state=closed]:zoom-out-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:zoom-in-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:fade-in-0 group-data-[viewport=false]/navigation-menu:data-[state=closed]:fade-out-0 group-data-[viewport=false]/navigation-menu:top-full group-data-[viewport=false]/navigation-menu:mt-1.5 group-data-[viewport=false]/navigation-menu:overflow-hidden group-data-[viewport=false]/navigation-menu:rounded-md group-data-[viewport=false]/navigation-menu:border group-data-[viewport=false]/navigation-menu:shadow group-data-[viewport=false]/navigation-menu:duration-200 **:data-[slot=navigation-menu-link]:focus:ring-0 **:data-[slot=navigation-menu-link]:focus:outline-none",e),...n})}function ey({className:e,...n}){return(0,t.jsx)("div",{className:(0,o.cn)("absolute top-full left-0 isolate z-50 flex justify-center"),children:(0,t.jsx)(en,{"data-slot":"navigation-menu-viewport",className:(0,o.cn)("origin-top-center bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border shadow md:w-[var(--radix-navigation-menu-viewport-width)]",e),...n})})}function eb({className:e,...n}){return(0,t.jsx)($,{"data-slot":"navigation-menu-link",className:(0,o.cn)("data-[active=true]:focus:bg-accent data-[active=true]:hover:bg-accent data-[active=true]:bg-accent/50 data-[active=true]:text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus-visible:ring-ring/50 [&_svg:not([class*='text-'])]:text-muted-foreground flex flex-col gap-1 rounded-sm p-2 text-sm transition-all outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&_svg:not([class*='size-'])]:size-4",e),...n})}var eC=e.i(630374),ek=e.i(313096);function eT(){let e=(0,s.usePathname)(),[i,l]=(0,a.useState)(!1),{userRole:d}=(0,ek.useUserStats)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eh,{viewport:!1,children:(0,t.jsxs)(ev,{className:"flex-wrap",children:[(0,t.jsx)(eg,{children:(0,t.jsx)(eb,{asChild:!0,className:(0,o.cn)(ew(),"/models"===e?"text-foreground":"text-muted-foreground"),children:(0,t.jsx)(n.default,{href:"/models",children:(0,t.jsx)(r.I18nText,{token:"models",zhClassName:"text-sm",zhSpacing:"0.1em"})})})}),(0,t.jsxs)(eg,{children:[(0,t.jsx)(ej,{className:(0,o.cn)(["/agent","/prompt","/workflow"].includes(e)?"text-foreground":"text-muted-foreground"),onMouseEnter:e=>e.currentTarget.click(),children:(0,t.jsx)(r.I18nText,{token:"explore",zhClassName:"text-sm",zhSpacing:"0.1em"})}),(0,t.jsx)(eN,{children:(0,t.jsxs)("div",{className:"grid w-[220px] gap-1 p-1",children:[(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/agent",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"agents",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/prompt",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"prompts",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/workflow",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"workflows",zhClassName:"text-sm",zhSpacing:"0.1em"})})})]})})]}),(0,t.jsxs)(eg,{children:[(0,t.jsx)(ej,{className:(0,o.cn)("/playground"===e?"text-foreground":"text-muted-foreground"),onMouseEnter:e=>e.currentTarget.click(),children:(0,t.jsx)(r.I18nText,{token:"playground",zhClassName:"text-sm",zhSpacing:"0.1em"})}),(0,t.jsx)(eN,{children:(0,t.jsxs)("div",{className:"grid w-[220px] gap-1 p-1",children:[(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/playground/chat",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"chat_model",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/playground/generate",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"generate_model",zhClassName:"text-sm",zhSpacing:"0.1em"})})})]})})]}),(0,t.jsxs)(eg,{children:[(0,t.jsx)(ej,{className:(0,o.cn)(["/updates","/bonuses","/docs","/games"].includes(e)?"text-foreground":"text-muted-foreground"),onMouseEnter:e=>e.currentTarget.click(),children:(0,t.jsx)(r.I18nText,{token:"more",zhClassName:"text-sm",zhSpacing:"0.1em"})}),(0,t.jsx)(eN,{children:(0,t.jsxs)("div",{className:"grid w-[200px] gap-1 p-1",children:[(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)("button",{className:"w-full text-left rounded-sm text-sm font-medium text-muted-foreground hover:bg-accent hover:text-accent-foreground px-3 py-2 transition-colors",onClick:()=>l(!0),children:(0,t.jsx)(r.I18nText,{token:"group_chat",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/updates",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"updates",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/bonuses",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"bonuses",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/docs",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"docs",zhClassName:"text-sm",zhSpacing:"0.1em"})})}),(0,t.jsx)(eb,{asChild:!0,children:(0,t.jsx)(n.default,{href:"/games",className:"rounded-sm text-sm font-medium text-muted-foreground",children:(0,t.jsx)(r.I18nText,{token:"games",zhClassName:"text-sm",zhSpacing:"0.1em"})})})]})})]})]})}),(0,t.jsx)(eC.Dialog,{open:i,onOpenChange:l,children:(0,t.jsx)(eC.DialogContent,{className:"sm:max-w-md flex justify-center items-center p-0 overflow-hidden bg-transparent border-none shadow-none",children:(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("img",{src:"/icons/group.jpg",alt:"Group QR",className:"max-w-[80vw] max-h-[80vh] rounded-lg shadow-lg"})})})})]})}e.s(["SiteNavLinks",()=>eT],892182)},648782,e=>{"use strict";var t=e.i(843476),n=e.i(271645),a=e.i(920755),r=e.i(475254);let s=(0,r.default)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),o=(0,r.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var i=e.i(728231),l=e.i(647163);function d(){let[e,r]=(0,n.useState)(null),d=(0,a.createClient)();if((0,n.useEffect)(()=>{let e=null;return(async()=>{let{data:{user:t}}=await d.auth.getUser();if(!t)return r(null);let{data:n}=await d.rpc("get_user_stats"),a=n?.role||"T0";(e=d.channel("online-users",{config:{presence:{key:"user"}}})).on("presence",{event:"sync"},()=>{let t=e?.presenceState()||{},n=new Map;for(let e in t)t[e].forEach(e=>{e.user_id&&!n.has(e.user_id)&&n.set(e.user_id,e.role||"T0")});let a=0,s=0,o=0,i=0,l=0;n.forEach(e=>{let t=e?.toUpperCase()||"T0";"T1"===t?s++:"T2"===t?o++:"T3"===t?i++:"T4"===t||"T5"===t||"T6"===t||"T71"===t||"ADMIN"===t?l++:a++}),r({total:Math.max(n.size,1),t0:a,t1:s,t2:o,t3:i,t71:l})}).subscribe(async n=>{"SUBSCRIBED"===n&&await e?.track({user_id:t.id,role:a,online_at:new Date().toISOString()})})})(),()=>{e&&d.removeChannel(e)}},[]),null===e)return null;let u="text-green-500",c="服务器稳定",m="稳dei很~",x=+e.t1+2*e.t2+3*e.t3+3*e.t71;return x>1200?(u="text-red-500",c="服务器过载",m="大哥们我错了~"):x>=1e3&&(u="text-yellow-500",c="服务器繁忙",m="不要慌~"),(0,t.jsx)(i.TooltipProvider,{children:(0,t.jsxs)(i.Tooltip,{children:[(0,t.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-md hover:bg-accent/50 transition-colors cursor-default select-none",children:(0,t.jsx)(s,{className:(0,l.cn)("h-5 w-5",u),strokeWidth:3})})}),(0,t.jsx)(i.TooltipContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-[auto_1fr_auto] gap-x-2 gap-y-1 text-white dark:text-black",children:[(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)(o,{className:"h-4 w-4"})}),(0,t.jsx)("span",{className:"text-left text-xs self-center",children:"在线人数:"}),(0,t.jsxs)("span",{className:"text-right text-xs self-center",children:[e.total,"人"]}),(0,t.jsx)("span",{className:"font-mono text-center text-xs self-center",children:"T0"}),(0,t.jsx)("span",{className:"text-left text-xs self-center",children:"免费用户:"}),(0,t.jsxs)("span",{className:"text-right text-xs self-center",children:[e.t0,"人"]}),(0,t.jsx)("span",{className:"font-mono text-center text-xs self-center",children:"T1"}),(0,t.jsx)("span",{className:"text-left text-xs self-center",children:"月度用户:"}),(0,t.jsxs)("span",{className:"text-right text-xs self-center",children:[e.t1,"人"]}),(0,t.jsx)("span",{className:"font-mono text-center text-xs self-center",children:"T2"}),(0,t.jsx)("span",{className:"text-left text-xs self-center",children:"季度用户:"}),(0,t.jsxs)("span",{className:"text-right text-xs self-center",children:[e.t2,"人"]}),(0,t.jsx)("span",{className:"font-mono text-center text-xs self-center",children:"T3"}),(0,t.jsx)("span",{className:"text-left text-xs self-center",children:"赞助会员:"}),(0,t.jsxs)("span",{className:"text-right text-xs self-center",children:[e.t3,"人"]}),(0,t.jsx)("span",{className:"font-mono text-center text-xs self-center",children:"T71"}),(0,t.jsx)("span",{className:"text-left text-xs self-center",children:"企业用户:"}),(0,t.jsxs)("span",{className:"text-right text-xs self-center",children:[e.t71,"人"]}),(0,t.jsxs)("div",{className:"col-span-3 flex justify-between items-center text-xs mt-1 border-t pt-1 border-white/20 dark:border-black/20",children:[(0,t.jsx)("span",{className:(0,l.cn)("font-bold",u),children:c}),(0,t.jsx)("span",{className:(0,l.cn)("font-bold ml-2",u),children:m})]})]})})]})})}e.s(["OnlineUsers",()=>d],648782)}]);
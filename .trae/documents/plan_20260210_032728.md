# 登录注册弹窗化改造计划

用户希望将登录和注册功能从独立页面改为悬浮弹窗（类似联系客服窗口），以提升体验。

## 1. 状态管理改造 (`frontend/src/store/authStore.ts`)
我们需要在全局 `authStore` 中添加控制弹窗显示的状态，以便在任何页面（如 Header 或 Gallery）都能唤起它。

- **新增状态**:
    - `isAuthModalOpen`: boolean - 控制弹窗是否显示。
    - `authModalTab`: 'login' | 'register' - 控制弹窗默认显示“登录”还是“注册”标签页。
- **新增动作**:
    - `openAuthModal(tab?: 'login' | 'register')`: 打开弹窗并切换到指定标签。
    - `closeAuthModal()`: 关闭弹窗。

## 2. 新增组件 `AuthModal.tsx`
创建一个新的全局弹窗组件，替代原有的 `Login.tsx` 和 `Register.tsx` 页面逻辑。

- **技术方案**:
    - 使用 `createPortal` 渲染到 `document.body`，确保层级正确。
    - 复用 `ContactModal` 的样式风格（磨砂玻璃、居中悬浮）。
    - 内部维护两个子组件或 Tab 切换逻辑：`LoginForm` 和 `RegisterForm`。
- **业务逻辑**:
    - **登录**: 成功后直接关闭弹窗，并在后台刷新用户信息（不再跳转页面）。
    - **注册**: 成功后自动切换到“登录”Tab，并自动填充账号（可选），或者直接自动登录。
    - **切换**: 底部提供“没有账号？去注册”和“已有账号？去登录”的快捷切换链接。

## 3. 全局挂载与路由调整 (`frontend/src/App.tsx`)
- 在 `App` 组件的根部挂载 `<AuthModal />`，使其在整个应用生命周期内可用。
- (可选) 保留 `/login` 和 `/register` 路由作为兼容，但将其行为改为“重定向到首页并自动打开对应弹窗”，或者直接移除这两个路由。为了平滑过渡，建议保留路由但重定向。

## 4. 组件触发点更新
将原本跳转到 `/login` 或 `/register` 的链接改为调用 `openAuthModal`。

- **`Header.tsx`**: 导航栏右侧的“登录/注册”按钮改为点击触发弹窗。
- **`LoginGuideModal.tsx`**: 之前的“请先登录”引导弹窗中的按钮，也改为触发这个新的 AuthModal，实现无缝衔接。
- **`Gallery.tsx`**: 如果有其他直接跳转逻辑，一并更新。

## 5. 验证计划
- 验证点击 Header 登录按钮是否弹出窗口。
- 验证弹窗内登录成功后是否自动关闭且状态更新为已登录。
- 验证注册流程是否顺畅（注册 -> 登录 -> 成功）。
- 验证在 Gallery 页面触发未登录操作时，能否通过新弹窗登录并保留在当前页面。

**Implementation Plan: Restore Uploaded Image in "Make Same Style"**

The "Make Same Style" functionality currently fails to carry over the reference image because:
1.  **Backend**: The API endpoints (`/generation/history` and `/gallery/list`) do not return the `reference_image_url` field from the database, even though it is stored.
2.  **Frontend**: The frontend components (`Gallery`, `Home`, `GeneratePanel`) do not pass or handle this field in the "Make Same Style" data flow.

I will implement the following changes to restore this functionality:

### 1. Backend Updates
*   **Modify `worker/src/routes/generation.ts`**: Update the SQL query in the `GET /history` endpoint to include the `reference_image_url` field.
*   **Modify `worker/src/routes/gallery.ts`**: Update the SQL query in the `GET /list` endpoint to include the `reference_image_url` field.

### 2. Frontend Updates
*   **Modify `frontend/src/pages/Gallery.tsx`**:
    *   Update the `GalleryItem` interface to include `reference_image_url`.
    *   In `handleMakeSameStyle`, pass the `referenceImage: item.reference_image_url` in the navigation state.
*   **Modify `frontend/src/pages/Home.tsx`**:
    *   In `handleReuse`, extract `reference_image_url` from the history item and pass it to `GeneratePanel` via `setGeneratePanelInitialData`.
*   **Modify `frontend/src/components/GeneratePanel.tsx`**:
    *   Update `GeneratePanelProps` to accept `referenceImage` in `initialData`.
    *   Update the `useEffect` hook to detect `initialData.referenceImage` and populate the `referenceImages` state (restoring the uploaded image).

**Note**: Currently, the database only stores the **first** reference image used in a generation. Therefore, this restoration will bring back the primary reference image.

# Admin Panel Enhancement Plan: User Image Filtering & Viewing

## 1. Backend Changes (`worker/src/routes/admin.ts`)

*   **Modify `GET /api/admin/generations` Endpoint**:
    *   **Query Parameters**: Accept an optional `userId` parameter.
    *   **Data Retrieval**:
        *   Update the SQL query to select `result_urls` (to allow image display).
        *   Add a `WHERE` clause to filter by `g.user_id` if the `userId` parameter is provided.
    *   **Response Formatting**:
        *   Parse the `result_urls` JSON string into an array.
        *   Ensure the response includes the image URLs.
    *   **Count Query**: Update the total count query to also respect the `userId` filter.

## 2. Frontend Changes (`frontend/src/pages/Admin.tsx`)

*   **State Management**:
    *   Add a state variable `genUserIdFilter` to store the User ID to filter by.
*   **"Generations" Tab Updates**:
    *   **Filter UI**: Add an input field and "Filter" button above the table to allow manual entry of a User ID.
    *   **Table Columns**: Add a new "Preview" (预览) column.
    *   **Image Display**: Render a thumbnail of the generated image (using the first URL from `result_urls`). Clicking the thumbnail will open the full image in a new tab.
*   **"Users" Tab Integration (UX Improvement)**:
    *   Add a "View Images" (查看图片) button in the user list actions.
    *   Clicking this button will:
        1.  Set `genUserIdFilter` to the selected user's ID.
        2.  Switch `activeTab` to `'generations'`.
        3.  Automatically trigger the data load for that user's images.

## 3. Execution Steps
1.  **Update Backend**: Modify `admin.ts` to support filtering and return image URLs.
2.  **Update Frontend**: Modify `Admin.tsx` to add the filter UI, image column, and cross-tab navigation logic.
3.  **Verify**: Test filtering by entering an ID and by clicking from the user list.
